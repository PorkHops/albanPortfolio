@using MudBlazor
@using System.Text.Json
@using System.IO
@inject IWebHostEnvironment Environment

<MudStack Row="true" Justify="@Justify" Spacing="4">
    @foreach (var link in socialLinks)
    {
        <MudIconButton Icon="@link.GetIconString()"
                     Color="@(Enum.Parse<Color>(link.Color))"
                     Size="@Size"
                     Href="@link.Url"
                     Target="_blank" />
    }
</MudStack>

@code {
    [Parameter]
    public Justify Justify { get; set; } = Justify.Center;

    [Parameter]
    public Size Size { get; set; } = Size.Large;

    private List<SocialLink> socialLinks = new();

    protected override Task OnInitializedAsync()
    {
        LoadContactInfo();
        return Task.CompletedTask;
    }

    private void LoadContactInfo()
    {
        try
        {
            var filePath = Path.Combine(Environment.ContentRootPath, "Components", "Utils", "Contact.json");
            Console.WriteLine($"Loading contact info from: {filePath}");
            var jsonString = File.ReadAllText(filePath);
            var response = JsonSerializer.Deserialize<ContactData>(jsonString, new JsonSerializerOptions
            {
                PropertyNameCaseInsensitive = true
            });
            if (response?.SocialLinks != null)
            {
                socialLinks = response.SocialLinks;
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading contact info: {ex.Message}");
        }
    }
}